<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - GreenGrocer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary-color: #000000;
            --secondary-color: #ffffff;
            --accent-color: #808080;
            --light-gray: #f5f5f5;
            --dark-gray: #333333;
        }

        body {
            font-family: 'Poppins', sans-serif;
            scroll-behavior: smooth;
            line-height: 1.6;
            color: var(--primary-color);
            background-color: var(--light-gray);
        }

        .navbar {
            background-color: var(--primary-color);
            color: var(--secondary-color);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            border: 1px solid var(--accent-color);
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .quantity-selector button {
            background-color: var(--light-gray);
            color: var(--dark-gray);
            padding: 0.5rem 1rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .quantity-selector button:hover {
            background-color: var(--accent-color);
        }

        .quantity-input {
            width: 3rem;
            text-align: center;
            border: none;
            border-left: 1px solid var(--accent-color);
            border-right: 1px solid var(--accent-color);
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-color);
            color: var(--secondary-color);
            padding: 12px 24px;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .cart-item {
            transition: all 0.2s ease;
            background-color: var(--secondary-color);
            border: 1px solid var(--accent-color);
        }

        .cart-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .clear-cart-btn {
            background-color: var(--dark-gray);
            color: var(--secondary-color);
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            transition: background-color 0.2s;
        }
        
        .clear-cart-btn:hover {
            background-color: var(--primary-color);
        }

        .checkout-btn {
            background-color: var(--primary-color);
            color: var(--secondary-color);
        }

        .checkout-btn:hover {
            background-color: var(--dark-gray);
        }
    </style>
</head>
<body>
    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <nav class="navbar">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <a href="index.html" class="text-white text-2xl font-bold flex items-center">
                        <img src="https://i.postimg.cc/3JGZ9FmJ/pngegg.png" alt="GreenGrocer Logo" class="h-12 mr-2">
                        GreenGrocer
                    </a>
                </div>

                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html#home" class="text-white hover:text-gray-300 transition">Home</a>
                    <a href="index.html#sellers" class="text-white hover:text-gray-300 transition">Shop</a>
                    <a href="index.html#contact" class="text-white hover:text-gray-300 transition">Contact</a>
                </div>

                <div class="md:hidden flex items-center">
                    <button class="text-white focus:outline-none" id="mobile-menu-button">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>

                <div class="ml-4 relative">
                    <a href="cart.html" class="text-white hover:text-gray-300 transition">
                        <i class="fas fa-shopping-cart text-2xl"></i>
                        <span id="cart-count" class="absolute -top-2 -right-2 bg-gray-500 text-white text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center">0</span>
                    </a>
                </div>
            </div>

            <div class="md:hidden hidden pt-4" id="mobile-menu">
                <a href="index.html#home" class="block py-2 text-white hover:text-gray-300 transition">Home</a>
                <a href="index.html#sellers" class="block py-2 text-white hover:text-gray-300 transition">Shop</a>
                <a href="index.html#contact" class="block py-2 text-white hover:text-gray-300 transition">Contact</a>
            </div>
        </div>
    </nav>

    <section class="py-12">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800">Your Shopping Cart</h1>
                <button id="clear-cart-btn" class="clear-cart-btn hidden">
                    <i class="fas fa-trash mr-2"></i>Clear Cart
                </button>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2">
                    <div id="cart-items-container" class="bg-white rounded-xl shadow-lg p-6 border border-gray-300">
                        <!-- Cart items will be loaded here -->
                        <div id="empty-cart-message" class="text-center py-12">
                            <i class="fas fa-shopping-cart text-4xl text-gray-400 mb-4"></i>
                            <h3 class="text-xl font-semibold text-gray-700 mb-2">Your cart is empty</h3>
                            <p class="text-gray-500 mb-4">Looks like you haven't added anything to your cart yet</p>
                            <a href="index.html" class="bg-black text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-800 transition">
                                Continue Shopping
                            </a>
                        </div>
                    </div>
                </div>
                
                <div>
                    <div class="bg-white rounded-xl shadow-lg p-6 sticky top-4 border border-gray-300">
                        <h2 class="text-xl font-semibold text-gray-800 mb-4">Order Summary</h2>
                        <div class="space-y-4 mb-6">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Items (<span id="item-count">0</span>)</span>
                                <span id="subtotal" class="font-medium">₹0.00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Delivery</span>
                                <span class="font-medium">FREE</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Tax (10%)</span>
                                <span id="tax" class="font-medium">₹0.00</span>
                            </div>
                            <div class="border-t border-gray-300 pt-4 flex justify-between">
                                <span class="text-lg font-semibold">Total</span>
                                <span id="total" class="text-lg font-bold">₹0.00</span>
                            </div>
                        </div>
                        <button id="checkout-btn" class="w-full checkout-btn py-3 rounded-lg font-semibold hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                            Proceed to Checkout
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-gray-900 text-white pt-12 pb-6">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-8 mb-8">
                <div>
                    <img src="https://i.postimg.cc/3JGZ9FmJ/pngegg.png" alt="GreenGrocer Logo" class="h-12 mb-4">
                    <p class="mb-4">The customer is at the heart of our unique business model, which includes design.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="hover:text-gray-400 transition"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="hover:text-gray-400 transition"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="hover:text-gray-400 transition"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="hover:text-gray-400 transition"><i class="fab fa-pinterest"></i></a>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4 text-gray-400">SHOPPING</h4>
                    <ul class="space-y-2">
                        <li><a href="vegetables.html" class="hover:text-gray-400 transition">Vegetable Store</a></li>
                        <li><a href="fruits.html" class="hover:text-gray-400 transition">Fruits Store</a></li>
                        <li><a href="plants.html" class="hover:text-gray-400 transition">Plants Store</a></li>
                        <li><a href="flower.html" class="hover:text-gray-400 transition">Flowers Store</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4 text-gray-400">CUSTOMER SERVICE</h4>
                    <ul class="space-y-2">
                        <li><a href="#contact" class="hover:text-gray-400 transition">Contact Us</a></li>
                        <li><a href="#" class="hover:text-gray-400 transition">Payment Method</a></li>
                        <li><a href="#" class="hover:text-gray-400 transition">Delivery</a></li>
                        <li><a href="#" class="hover:text-gray-400 transition">Return and Exchange</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4 text-gray-400">CONTACT INFO</h4>
                    <ul class="space-y-2">
                        <li><i class="fas fa-map-marker-alt mr-2"></i> 123 Green Street, Garden City</li>
                        <li><i class="fas fa-phone mr-2"></i> +1 (555) 123-4567</li>
                        <li><i class="fas fa-envelope mr-2"></i> info@greengrocer.com</li>
                        <li><i class="fas fa-clock mr-2"></i> Mon-Sat: 8AM - 8PM</li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 pt-6 text-center text-gray-400">
                <p>&copy; 2025 GreenGrocer. All rights reserved. Design and Code by Krishna & Nitesh</p>
            </div>
        </div>
    </footer>

    <script>
        // Toast notification function
        function showToast(message, duration = 3000) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // Update cart count in navbar
        function updateCartCount() {
            try {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
                document.getElementById('cart-count').textContent = totalItems;
                
                // Show/hide clear cart button based on cart contents
                const clearCartBtn = document.getElementById('clear-cart-btn');
                if (cart.length > 0) {
                    clearCartBtn.classList.remove('hidden');
                } else {
                    clearCartBtn.classList.add('hidden');
                }
                
                // Add animation to cart icon
                const cartIcon = document.querySelector('.fa-shopping-cart').parentElement;
                cartIcon.classList.add('animate-ping');
                setTimeout(() => {
                    cartIcon.classList.remove('animate-ping');
                }, 500);
            } catch (e) {
                console.error('Error updating cart count:', e);
            }
        }

        // Calculate and update order summary
        function updateOrderSummary() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.1; // 10% tax
            const total = subtotal + tax;

            document.getElementById('subtotal').textContent = `₹${subtotal.toFixed(2)}`;
            document.getElementById('tax').textContent = `₹${tax.toFixed(2)}`;
            document.getElementById('total').textContent = `₹${total.toFixed(2)}`;
            document.getElementById('item-count').textContent = cart.reduce((total, item) => total + item.quantity, 0);
            
            // Enable/disable checkout button based on cart contents
            document.getElementById('checkout-btn').disabled = cart.length === 0;
            
            return total;
        }

        // Load cart items from localStorage and display them
        function loadCartItems() {
            try {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                const container = document.getElementById('cart-items-container');
                const emptyCartMessage = document.getElementById('empty-cart-message');
                
                if (cart.length === 0) {
                    emptyCartMessage.classList.remove('hidden');
                    container.innerHTML = '';
                    container.appendChild(emptyCartMessage);
                    return;
                }
                
                emptyCartMessage.classList.add('hidden');
                
                // Clear container and add cart items
                container.innerHTML = '';
                
                cart.forEach((item, index) => {
                    const itemTotal = item.price * item.quantity;
                    
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item flex flex-col sm:flex-row border-b border-gray-300 py-6 px-4 rounded-lg mb-4';
                    cartItem.dataset.index = index;
                    
                    cartItem.innerHTML = `
                        <div class="flex-shrink-0 mb-4 sm:mb-0 sm:mr-6">
                            <img src="${item.image}" alt="${item.name}" class="w-24 h-24 object-contain">
                        </div>
                        <div class="flex-grow">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800">${item.name}</h3>
                                    <p class="font-bold mt-1">₹${item.price.toFixed(2)}</p>
                                </div>
                                <button class="remove-item text-gray-700 hover:text-black" data-index="${index}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                            <div class="mt-4 flex items-center">
                                <div class="quantity-selector mr-6">
                                    <button class="decrease-qty px-3 py-1" data-index="${index}">
                                        <i class="fas fa-minus"></i>
                                    </button>
                                    <input type="number" class="quantity-input" value="${item.quantity}" min="1" max="99" data-index="${index}">
                                    <button class="increase-qty px-3 py-1" data-index="${index}">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                                <span class="text-lg font-semibold">₹${itemTotal.toFixed(2)}</span>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(cartItem);
                });
                
                // Add event listeners to all interactive elements
                setupCartItemEvents();
                
            } catch (e) {
                console.error('Error loading cart items:', e);
                showToast('Error loading cart. Please try again.');
            }
        }

        // Setup event listeners for cart items
        function setupCartItemEvents() {
            // Quantity decrease buttons
            document.querySelectorAll('.decrease-qty').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.dataset.index);
                    updateCartItemQuantity(index, -1);
                });
            });
            
            // Quantity increase buttons
            document.querySelectorAll('.increase-qty').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.dataset.index);
                    updateCartItemQuantity(index, 1);
                });
            });
            
            // Quantity input changes
            document.querySelectorAll('.quantity-input').forEach(input => {
                input.addEventListener('change', function() {
                    const index = parseInt(this.dataset.index);
                    const newQuantity = parseInt(this.value);
                    
                    if (isNaN(newQuantity) || newQuantity < 1) {
                        this.value = 1;
                        updateCartItemQuantity(index, 0, 1);
                    } else if (newQuantity > 99) {
                        this.value = 99;
                        updateCartItemQuantity(index, 0, 99);
                    } else {
                        updateCartItemQuantity(index, 0, newQuantity);
                    }
                });
            });
            
            // Remove item buttons
            document.querySelectorAll('.remove-item').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const index = parseInt(this.dataset.index);
                    removeCartItem(index);
                });
            });
        }

        // Update cart item quantity
        function updateCartItemQuantity(index, change, setValue = null) {
            try {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                
                if (index >= 0 && index < cart.length) {
                    if (setValue !== null) {
                        cart[index].quantity = setValue;
                    } else {
                        cart[index].quantity += change;
                        
                        // Ensure quantity stays between 1 and 99
                        if (cart[index].quantity < 1) cart[index].quantity = 1;
                        if (cart[index].quantity > 99) cart[index].quantity = 99;
                    }
                    
                    localStorage.setItem('cart', JSON.stringify(cart));
                    loadCartItems();
                    updateCartCount();
                    updateOrderSummary();
                    showToast('Cart updated');
                }
            } catch (e) {
                console.error('Error updating cart item quantity:', e);
                showToast('Error updating quantity. Please try again.');
            }
        }

        // Remove item from cart
        function removeCartItem(index) {
            try {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                
                if (index >= 0 && index < cart.length) {
                    const removedItem = cart[index].name;
                    cart.splice(index, 1);
                    localStorage.setItem('cart', JSON.stringify(cart));
                    loadCartItems();
                    updateCartCount();
                    updateOrderSummary();
                    showToast(`${removedItem} removed from cart`);
                }
            } catch (e) {
                console.error('Error removing cart item:', e);
                showToast('Error removing item. Please try again.');
            }
        }
        
        // Clear entire cart
        function clearCart() {
            try {
                localStorage.removeItem('cart');
                loadCartItems();
                updateCartCount();
                updateOrderSummary();
                showToast('Cart cleared');
            } catch (e) {
                console.error('Error clearing cart:', e);
                showToast('Error clearing cart. Please try again.');
            }
        }

        // Setup checkout button
        function setupCheckoutButton() {
            document.getElementById('checkout-btn').addEventListener('click', function() {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                if (cart.length === 0) {
                    showToast('Your cart is empty');
                    return;
                }
                
                const total = updateOrderSummary();
                window.location.href = `payment.html?total=${total.toFixed(2)}`;
            });
        }
        
        // Setup clear cart button
        function setupClearCartButton() {
            document.getElementById('clear-cart-btn').addEventListener('click', function() {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                if (cart.length === 0) {
                    showToast('Your cart is already empty');
                    return;
                }
                
                if (confirm('Are you sure you want to clear your cart?')) {
                    clearCart();
                }
            });
        }

        // Initialize page when loaded
        window.onload = function() {
            updateCartCount();
            loadCartItems();
            updateOrderSummary();
            setupCheckoutButton();
            setupClearCartButton();
        };
    </script>
</body>
</html>